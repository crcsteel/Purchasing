<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
	<title>Purchase Backorder</title>
  <link rel="icon" type="image/png" href="img/CRC_LogoEN.jpg">
  <link rel="stylesheet" href="css/style.css">

</head>
<body>	
	<!-- SIDEBAR -->
    <div id="sidebar"></div>
	<!-- SIDEBAR -->

	<!-- CONTENT -->
	<section id="content">
		<!-- NAVBAR -->
		<nav>


			<form action="#">
				<div class="form-group">
					<h1 class="title">Purchase Backorder</h1>
				</div>
			</form>
			<span class="divider"></span>
			<div class="profile">
				<img src="https://crcsteel.co.th/upload-img/CRC_steel/logo_CRC_vdo-01_1665974907.png" alt="Logo">
			</div>
		</nav>
		<!-- NAVBAR -->

		<!-- MAIN -->
		<main>
            <div class="data">
				<div class="content-data">
					<div class="head">
						<h3 id="pageTitle">ประมาณการสินค้าค้างรับ</h3>
					</div>
					<div class="iframe" style="position:relative;">
	<!-- Loader -->
						<div id="iframeLoader" 
							style="position:absolute;top:0;left:0;width:100%;height:100%;
							display:flex;align-items:center;justify-content:center;
							background:#fff;z-index:10;">
							<p>⏳ กำลังโหลด...</p>
						</div>

						<!-- iframe -->
						<iframe id="reportFrame"
							src="https://script.google.com/macros/s/AKfycbxhBVRYDhIE9P6T4sIQOKG_Oa_l2CSp-6rThPpK0cuntHcvlHM-Fssa0Gvs8f7GNrc_SA/exec" 
							width="100%" height="650px" frameborder="0"></iframe>
					</div>
				</div>
            </div>
		</main>
		<!-- MAIN -->
	</section>
	<!-- CONTENT -->

  <!-- Scripts -->
	<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
	<script src="script/script.js"></script>
  <script src="script/base.js"></script>
  <script src="script/inventory.js"></script>
  <script src="script/inventoryout.js"></script>
  <script src="script/salesandbase.js"></script>
  <script src="script/salesdaily.js"></script>
  <script>    
    // โหลด sidebar.html ก่อน
    fetch('page/sidebar.html')
      .then(res => res.text())
      .then(html => {
        document.getElementById('sidebar').innerHTML = html;
        initSidebar(); // เรียกฟังก์ชันตั้งค่า Sidebar หลังโหลดเสร็จ
      })
      .catch(err => console.error('โหลด Sidebar ไม่ได้:', err));

    function initSidebar() {
      const allDropdown = document.querySelectorAll('#sidebar .side-dropdown');
      const sidebar = document.getElementById('sidebar');
      const toggleSidebar = document.querySelector('nav .toggle-sidebar');
      const allSideDivider = document.querySelectorAll('#sidebar .divider');

      // ===== Dropdown =====
      allDropdown.forEach(item => {
        const a = item.parentElement.querySelector('a:first-child');
        a.addEventListener('click', function (e) {
          e.preventDefault();
          if (!this.classList.contains('active')) {
            allDropdown.forEach(i => {
              const aLink = i.parentElement.querySelector('a:first-child');
              aLink.classList.remove('active');
              i.classList.remove('show');
            });
          }
          this.classList.toggle('active');
          item.classList.toggle('show');
        });
      });

      // ===== Collapse =====
      if (sidebar.classList.contains('hide')) {
        allSideDivider.forEach(item => item.textContent = '-');
      } else {
        allSideDivider.forEach(item => item.textContent = item.dataset.text);
      }

      toggleSidebar.addEventListener('click', function () {
        sidebar.classList.toggle('hide');
        if (sidebar.classList.contains('hide')) {
          allSideDivider.forEach(item => item.textContent = '-');
          allDropdown.forEach(item => {
            const a = item.parentElement.querySelector('a:first-child');
            a.classList.remove('active');
            item.classList.remove('show');
          });
        } else {
          allSideDivider.forEach(item => item.textContent = item.dataset.text);
        }
      });

      // Hover event
      sidebar.addEventListener('mouseleave', function () {
        if (this.classList.contains('hide')) {
          allSideDivider.forEach(item => item.textContent = '-');
        }
      });
      sidebar.addEventListener('mouseenter', function () {
        if (this.classList.contains('hide')) {
          allSideDivider.forEach(item => item.textContent = item.dataset.text);
        }
      });
    }
  </script>

</body>
</html>
